<!DOCTYPE html>
<html lang="en">
{% load staticfiles %}
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="sipei">
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}"/>
    <link rel="stylesheet" href="{% static 'css/bootstrap-button.css' %}"/>
    <title>商品列表</title>
    --
    <style type="text/css">
        body {
            background: url({% static 'img/background.jpg'%}) no-repeat;

        }

        .menuItem {
            width: 100%;
            height: 70px;
            max-width: 400px;
            font: "微软雅黑";
            font-size: 40px;

        }

        .menuMargin {
            margin-top: 20px;
            margin-bottom: 30px;
        }

        .moneyInputText {
            width: 55%;
            height: 100px;
            font-size: 45px;
        }


    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-xs-12">
            <div class="page-header ">
                <button type="button" id="goBackBtn" class="btn btn-default btn-lg">
                    <span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span> 返回
                </button>
                <h1 class="text-center"><strong>商品列表</strong></h1>
                <div style="text-align: right">
                    <button type="button" id="goProductManageBtn" class="btn btn-default btn-lg">
                        详细操作<span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="btn-group">
        <button type="button" class="{% ifequal sort '' %}btn btn-success
{% else %}btn btn-default{% endifequal %}" onclick=sortBtn(0)>常规
        </button>
        <button type="button" class="{% ifequal sort 'supplier' %}btn btn-success
{% else %}btn btn-default{% endifequal %}" onclick=sortBtn(1)>供应商&#8595;</button>
        <button type="button" class="{% ifequal sort 'name' %}btn btn-success
{% else %}btn btn-default{% endifequal %}" onclick=sortBtn(2)>商品名称&#8595;</button>
        <button type="button" class="{% ifequal sort 'price' %}btn btn-success
{% else %}btn btn-default{% endifequal %}" onclick=sortBtn(3)>商品价格&#8595;</button>
        <button type="button" class="{% ifequal sort 'add_time' %}btn btn-success
{% else %}btn btn-default{% endifequal %}" onclick=sortBtn(4)>添加时间&#8595;</button>
    </div>
    <table class="table table-hover">
        <thead>
        <tr>
            <th>供应商</th>
            <th>商品名称</th>
            <th>商品数量</th>
            <th>商品单价</th>
            <th>添加时间</th>
        </tr>
        </thead>
        <tbody>
        {% for product in all_products %}
            <tr id="product_{{ product.id }}"{% if product.count <= product.min_count %}
                class="warning" style="color: red" {% endif %}>
                <td>{{ product.supplier }}</td>
                <td>{{ product.name }}</td>
                <td>{{ product.count }}</td>
                <td>{{ product.price }}</td>
                <td>{{ product.add_time }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<script type="text/javascript" src="{% static 'js/jquery-3.2.1.js' %}"></script>
<script type="text/javascript" src="{% static 'js/bootstrap.js' %}"></script>
<script type="text/javascript" src="{% static 'js/common.js' %}"></script>

<script type="text/javascript">
    $(document).ready(function () {

        setInterval(function () {
            $.ajax({
                type: 'get',
                url: "/product/getWarning"
            });
        }, 100000);

        {% ifequal total 0 %}
        {% else %}
            {% if not sort %}
                window.alert("有{{ total }}件货物库存不足，请及时补充");
            {% endif %}
        {% endifequal %}

        $('#goBackBtn').click(function () {
            window.location.href = '/';
        });

        $('#goProductManageBtn').click(function () {
            window.location.href = '/manage/product/product/';
        });

    });

    function sortBtn(k) {
        switch (k) {
            case 0:
                window.location.href = "?sort=";
                break;
            case 1:
                window.location.href = "?sort=supplier";
                break;
            case 2:
                window.location.href = "?sort=name";
                break;
            case 3:
                window.location.href = "?sort=price";
                break;
            case 4:
                window.location.href = "?sort=add_time";
                break;
            default:
                break;
        }
    }
</script>
</body>
</html>
